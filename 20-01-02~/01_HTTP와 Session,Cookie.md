# 191107 HTTP와 Session,Cookie

hyper Text Markup Language => HTML
hyper text  transfer protocol => http

html 파일: html로 작성된 문서 파일

웹의 동작 (HTTP 프로토콜의 이해)

#### HTTP 란?

- 웹 브라우저와 웹 서버 간의 서로 통신하기 위한 규약
  - 즉, HTTP(hyperText Transfer Protocol)란 서버와 클라이언트가 인터넷상에서 데이터를 주고받기 위한 프로토콜을 말한다.
  - HTTP는 발전하여  HTTP/2 버전이 등장한 상태
  - 어떤 종류의 데이터도 전송할 수 있도록 설계
- HTTP/HTTPs 차이
  - HTTP 프로토콜
    : 웹상으로 클라이언트와 서버 간에 요청/응답으로 정보를 주고 받을 수 있는 프로토콜
  - HTTPS 프로토콜
    : 웹 통신 프로토콜인 HTTP의 보안이 강화된 버전
     HTTPS는 소켓통신에서 일반 텍스트를 이용하는 대신에, SSL이나 TLS 프로토콜을 통해 세션 데이터를 암호화 한다
    따라서 데이터의 적절한 보호를 보장한다.



#### HTTP 통신 과정

- HTTP 는 서버/클라이언트 모델을 따른다.
  - 클라이언트 =>**요청**=>서버 =>**응답**=> 클라이언트
  - 특징
    - 비연결 지향(connectionless)
      : 클라이언트가 request를 보내고, 서버가 클라이언트에 요청에 맞는 response를 보내면 바로 연결을 끊는다.
    - 무상태(stateless)
      :연결을 끊는 순간 클라이언트와 서버의 통신은 끝나며 상태 정보를 유지하지 않는다.
  - 장점
    - 불특정 다수를 대상으로 하는 서비스에는 적합
    - 클라이언트와 서버가 계속 연결된 형태가 아니기 때문에 클라이언트와 서버 간의 최대 연결 수 보다 훨씬 많은 요청과 응답을 처리할 수 있다.
  - 단점
    - 연결을 끊어버리기 때문에, 클라이언트의 이전 상황을 알 수가 없다.
    - 이러한 특징을 무상태 라고 말한다.
    - 이러한 특징 때문에 정보를 유지하기 위해서 Cookie와 같은 기술이 등장하게 되었다.



#### HTTP 메시지 형식

HTTP Request 메시지  = Request Header + 빈줄 + Request Body

HTTP Response 메시지 = Response Header + 빈줄 + Response Body





#### HTTP 기본 속성 개념

- 요청 메서드

  - 서버에게 요청의 종류를 알려주기 위해 사용

  - 최초의 웹 서버는 GET 방식만 지원

  - 각 메서드의 사용 목적

    - GET: 정보 요청(select)

    - POST: 정보 밀어넣기(insert)

    - PUT: 정보 업데이트(update)

    - DELETE: 정보 삭제(delete)

      .. 등등

- 요청 URI

  - 요청하는 자원의 위치를 명시





#### URL(Uniform Resource Locator) 이란?

- **URL 이란**

  - 인터넷 상의 자원의 위치
  - 특정 웹 서버의 특정 파일에 접근하기 위한 경로 혹은 주소

- **URL의 표현**
- 접근 프로토콜:// IP주소 또는 도메인 이름(:포트번호)/자원의 경로/자원의 이름
  - ex) http://www.example.co.kr/text/index.html
  - ex) http://localhost:8080
  
- **URL와 URI의 차이**
- URI(Uniform Resource Identifier)
  
  - 요청하는 자원의 식별자(규약)
    - 자원을 고유하게 식별하고 위치를 지정할 수 있다.
    - URI의 하위 개념으로 URL이 포함된다. 즉 URI>URL
  
- URL(Uniform Resouce Locator)
  
  - 특정 웹 서버의 특정 자원에 대한 구체적인 위치(규약의 형태)
  
  - 자원의 정확한 위치와 접근학 위한 방법을 알려준다.
      ex)
  
    - 자원에 접근할 수 있는 위치는 https://gmlwjd9405.github.io/list이며, 이를 URL이라고 할 수 있다.
  
    - 하지만 원하는 자원을 얻기 위해서는 추가적인 식별자인 page=2가 필요하고 이를 포함한 내용까지가 URI라고 할 수 있다.
        https://gmlwjd9405.github.io/2019/04/17/what-is-http-protocol.html

#### 쿠키(Cookie) 란?

- 개념 

  - 클라이언트 로컬에 저장되는 키와 값이 들어있는 파일이다
  - 이름, 값, 유효 시간, 경로 등을 포함하고 있다.
  - 클라이언트의 상태 정보를 브라우저에 저장하여 참조한다.

- 구성요소

  - 이름, 값, 만료시간, 전송할 도메인 이름, 전송할 경로, 보안 연결 여부, HttpOnly여부

- 동작 방식

  -  **클라이언트** => Get/test =>**서버**=>Set-Cookie:id=boy => **클라이언트** =>Get/test Cookie: id=boy

  1. 웹 블라우저가 서버에 요청
  2. 상태를 유지 하고 싶은 값을 쿠키로 생성
  3. 서버가 응당합때  HTTP 헤더에 쿠키를 포함해서 전송
  4. 전달 받은 쿠키는 웹브라우저에서 관리하고 있다가, 다음 요청 때 쿠키를 HTTP 헤더에 넣어서 전송
  5. 서버에서는 쿠키 정보를 읽어 이전 상태 정보를 확인한 후 응답

- 쿠키 사용 예

  - 아이디, 비밀번호 저장
  - 쇼핑몰 장바구니



#### 세션(Session) 이란?

- 개념

  - 일정 시간 동안 같은 브라우저로부터 들어오는 요청을 하나의 상태로 보고 그 상태를 유지하는 기술이다.
  - 즉, 웹 브라우저를 통해 서버에 접속한 이후부터 브라우저를 종료할 때까지 유지되는 상태이다.

- 동작방식

  - **클라이언트** =>Post/login => **서버**=> set-cookie:jsessionid=xslei13f s=>**클라이언트** => get/test Cookie:jsessionid = xslei13fs =>**서버**

  1. 웹 브라우저가 서버에 요청
  2. 서버가 해당 웹브라우저(클라이언트)에 유일한 ID(Session ID)를 부여함
  3. 서버가 응답할 때 HTTP 헤더(Set-Cookie)에 Session ID를 포함해서 전송 쿠키에 Session Id를 JSESSIONID라는 이름으로 저장
  4. 웹브라우저는 이후 웹브라우저를 닫기까지 다음 요청 때 부여된 SessionId가 담겨있는 쿠키를 HTTP헤더에 넣어서 전송
  5. 서버는 세션 ID를 확인하고, 해당 세션에 관련된 정보를 확인 한 후 응답

- 세션 사용 예

  - 로그인



#### 쿠키와 세션의 차이점

- 저장 위치
  - 쿠키 : 클라이언트
  - 세션 : 서버
- 보안
  - 쿠키: 클라이언트에 저장되므로 보안에 취약하다.
  - 세션: 쿠키를 이용해 Session Id만 저장하고 이 값으로 구분해서 서버에서 처리하므로 비교적 보안성이 좋다.
- 라이프 사이클
  - 쿠키: 만료시간에 따라 브라우저를 종료해도 계속해서 남아 있을 수 있다.
  - 세션: 만룍 시간을 정할 수 있지만 브라우저가 종료되면 만료시간에 상관없이 삭제된다.
- 속도
  - 쿠키: 클라이언트에 저장되어서 서버에 요청시 빠르다.
  - 세션: 실제 저장된 정보가 서버에 있으므로 서버의 처리가 필요해 쿠키보다 느리다.